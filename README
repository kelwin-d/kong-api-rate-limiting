ğŸš€ API Rate Limiting with Kong API Gateway

This repository demonstrates how to implement API Rate Limiting using Kong API Gateway with Redis-based distributed limits. The setup includes:

âœ… Kong API Gateway (for traffic management)
âœ… Redis (for distributed rate limiting)
âœ… PostgreSQL (for Kong database storage)
âœ… Docker Compose (for easy deployment)

ğŸ“Œ Features

âœ” Rate Limiting per IP, API Key, or Consumer
âœ” Redis-based distributed Rate Limiting for scalability
âœ” Multiple Rate Limits (Per Second, Minute, Hour)
âœ” Monitoring via Kong Admin API

ğŸ“Œ Prerequisites

ğŸ”¹ Docker & Docker Compose installed â†’ Get Docker
ğŸ”¹ Curl or Postman for API testing

ğŸš€ Step 1: Clone the Repository

git clone https://github.com/kelwin-d/api-rate-limiting.git
cd api-rate-limiting

ğŸš€ Step 2: Start Kong, Redis & PostgreSQL Using Docker

docker-compose up -d
âœ… This starts Kong API Gateway, Redis, and PostgreSQL.

ğŸš€ Step 3: Configure Kong API Rate Limiting Plugin

1ï¸âƒ£ Enable Rate Limiting on an API Service

curl -X POST http://localhost:8001/services/my-api/plugins \
  --data "name=rate-limiting" \
  --data "config.minute=100" \
  --data "config.policy=redis" \
  --data "config.redis_host=redis"
âœ” Limits API calls to 100 per minute using Redis.

2ï¸âƒ£ Apply Rate Limiting Per Consumer (API Key-based Limit)

curl -X POST http://localhost:8001/consumers/my-consumer/plugins \
  --data "name=rate-limiting" \
  --data "config.minute=50" \
  --data "config.policy=redis" \
  --data "config.redis_host=redis"
âœ” Limits API requests to 50 per minute per consumer.

3ï¸âƒ£ Apply Rate Limiting Per Route

curl -X POST http://localhost:8001/routes/my-route/plugins \
  --data "name=rate-limiting" \
  --data "config.hour=500" \
  --data "config.policy=cluster"
âœ” Limits 500 API requests per hour for a specific route.

ğŸš€ Step 4: Test API Rate Limiting

Run this command to send 20 API requests quickly:

for i in {1..20}; do curl -i http://localhost:8000/my-api; done

ğŸ”¹ Expected Behavior:

First 10 requests succeed.
After 10 requests, Kong blocks further requests and returns:

{
  "message": "API rate limit exceeded. Try again later."
}

ğŸš€ Step 5: Monitor API Rate Limits

Check Active Rate Limits

curl -X GET http://localhost:8001/plugins?name=rate-limiting
Check Kong Logs

docker logs -f kong
ğŸ“Œ Troubleshooting
ğŸ”¹ If Kong does not start, check Docker logs:

docker logs -f kong
ğŸ”¹ If API requests exceed limits unexpectedly, verify Redis is running:

docker ps | grep redis
ğŸ“Œ Contributing
Feel free to fork this repo, open issues, and submit pull requests!

ğŸ“Œ License
This project is open-source and available under the MIT License.
